..
.. SPDX-License-Identifier: Apache-2.0
..

:github_url: https://github.com/IBM-Blockchain/ansible-collection/edit/master/plugins/modules/channel_config.py


channel_config -- Manage the configuration for a Hyperledger Fabric channel
===========================================================================

.. contents::
   :local:
   :depth: 1


Synopsis
--------

Fetch and update the configuration for a Hyperledger Fabric channel by using the IBM Blockchain Platform.

This module works with the IBM Blockchain Platform managed service running in IBM Cloud, or the IBM Blockchain Platform software running in a Red Hat OpenShift or Kubernetes cluster.






Parameters
----------

  api_endpoint (required)
    The URL for the IBM Blockchain Platform console.

    | **Type**: str

  api_authtype (required)
    ``ibmcloud`` - Authenticate to the IBM Blockchain Platform console using IBM Cloud authentication. You must provide a valid API key using *api_key*.

    ``basic`` - Authenticate to the IBM Blockchain Platform console using basic authentication. You must provide both a valid API key using *api_key* and API secret using *api_secret*.

    | **Type**: str

  api_key (required)
    The API key for the IBM Blockchain Platform console.

    | **Type**: str

  api_secret
    The API secret for the IBM Blockchain Platform console.

    Only required when *api_authtype* is ``basic``.

    | **Type**: str

  api_timeout
    The timeout, in seconds, to use when interacting with the IBM Blockchain Platform console.

    | **Type**: int
    | **Default value**: ``60``

  api_token_endpoint
    The IBM Cloud IAM token endpoint to use when using IBM Cloud authentication.

    Only required when *api_authtype* is ``ibmcloud``, and you are using IBM internal staging servers for testing.

    | **Type**: str
    | **Default value**: ``https://iam.cloud.ibm.com/identity/token``

  operation (required)
    ``create`` - Create a channel configuration update transaction for a new channel.

    ``fetch`` - Fetch the current channel configuration to the specified *path*.

    ``compute_update`` - Compute a channel configuration update transaction using the original configuration at *origin* and the updated configuration at *updated*.

    ``sign_update`` - Sign a channel configuration update transaction.

    ``apply_update`` - Apply a channel configuration update transaction.

    | **Type**: str

  ordering_service
    The ordering service to use to manage the channel.

    You can pass a string, which is the cluster name of a ordering service registered with the IBM Blockchain Platform console.

    You can also pass a list, which must match the result format of one of the :ref:`ordering_service_info <ordering_service_info_module>` or :ref:`ordering_service <ordering_service_module>` modules.

    Only required when *operation* is ``fetch`` or ``apply_update``.

    | **Type**: raw

  identity
    The identity to use when interacting with the ordering service or for signing channel configuration update transactions.

    You can pass a string, which is the path to the JSON file where the enrolled identity is stored.

    You can also pass a dict, which must match the result format of one of the :ref:`enrolled_identity_info <enrolled_identity_info_module>` or :ref:`enrolled_identity <enrolled_identity_module>` modules.

    Only required when *operation* is ``fetch``, ``sign_update``, or ``apply_update``.

    | **Type**: raw

  msp_id
    The MSP ID to use for interacting with the ordering service or for signing channel configuration update transactions.

    Only required when *operation* is ``fetch``, ``sign``, or ``apply_update``.

    | **Type**: str

  name (required)
    The name of the channel.

    | **Type**: str

  path (required)
    The path to the file where the channel configuration or the channel configuration update transaction will be stored.

    | **Type**: str

  original
    The path to the file where the original channel configuration is stored.

    Only required when *operation* is ``compute_update``.

    | **Type**: str

  updated
    The path to the file where the updated channel configuration is stored.

    Only required when *operation* is ``compute_update``.

    | **Type**: str

  organizations
    The list of organizations to add as members in the new channel.

    The organizations must all be members of the consortium.

    You can pass strings, which are the names of organizations that are registered with the IBM Blockchain Platform console.

    You can also pass a dict, which must match the result format of one of the :ref:`organization_info <organization_info_module>` or :ref:`organization <organization_module>` modules.

    Only required when *operation* is ``create``.

    | **Type**: list
    | **Elements**: raw

  policies
    The set of policies to add to the new channel. The keys are the policy names, and the values are the policies.

    You can pass strings, which are paths to JSON files containing policies in the Hyperledger Fabric format (common.Policy).

    You can also pass a dict, which must correspond to a parsed policy in the Hyperledger Fabric format (common.Policy).

    You must provide at least an Admins, Writers, and Readers policy.

    Only required when *operation* is ``create``.

    | **Type**: dict








Examples
--------

.. code-block:: yaml+jinja

    
    - name: Create the configuration for a new channel
      ibm.blockchain_platform.channel_config:
        api_endpoint: https://ibp-console.example.org:32000
        api_authtype: basic
        api_key: xxxxxxxx
        api_secret: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        operation: create
        name: mychannel
        path: channel_config_update.bin
        organizations:
          - Org1
        policies:
          Admins: admins-policy.json
          Readers: readers-policy.json
          Writers: writers-policy.json

    - name: Fetch the channel configuration
      ibm.blockchain_platform.channel_config:
        api_endpoint: https://ibp-console.example.org:32000
        api_authtype: basic
        api_key: xxxxxxxx
        api_secret: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        ordering_service: Ordering Service
        identity: Org1 Admin.json
        msp_id: Org1MSP
        operation: fetch
        name: mychannel
        path: channel_config.bin

    - name: Compute the configuration update for the channel
      ibm.blockchain_platform.channel_config:
        operation: compute_update
        name: mychannel
        original: original_channel_config.bin
        updated: updated_channel_config.bin
        path: channel_config_update.bin

    - name: Sign the configuration update for the channel
      ibm.blockchain_platform.channel_config:
        operation: sign_update
        identity: Org1 Admin.json
        msp_id: Org1MSP
        name: mychannel
        path: channel_config_update.bin

    - name: Apply the configuration update for the channel
      ibm.blockchain_platform.channel_config:
        api_endpoint: https://ibp-console.example.org:32000
        api_authtype: basic
        api_key: xxxxxxxx
        api_secret: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        ordering_service: Ordering Service
        identity: Org1 Admin.json
        msp_id: Org1MSP
        operation: apply_update
        name: mychannel
        path: channel_config_update.bin



Return Values
-------------

  path
    The path to the file where the channel configuration or the channel configuration update transaction is stored.

    | **Returned**: always
    | **Type**: str


